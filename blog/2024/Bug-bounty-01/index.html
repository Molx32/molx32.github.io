<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> CyberIntruder | Blog </title> <meta name="author" content="CyberIntruder - Molx32 "/> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://cyber-intruder.com/blog/2024/Bug-bounty-01/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://cyber-intruder.com/">CyberIntruder</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/about">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/fr-fr/blog/2024/Bug-bounty-01/"> FR-FR </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Bug bounty - Cybersecurity subcontractor exposes business data to other customers</h1> <p class="post-meta">June 1, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fas fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/bugbounty"> <i class="fas fa-hashtag fa-sm"></i> bugbounty</a>   </p> </header> <article class="post-content"> <h2 id="context">Context</h2> <p>At the time of the discovery, I worked as a security analyst, to handle security incidents and other operational activities. In order to generate and manage those security incidents, the company subscribed to a SOC service proposed by <b>REDACTED</b>. Initialy, <b>REDACTED</b> was not a security company, and their current website doesn’t even mention their cybersecurity services, yet they are spread accross many companies with their cybersecurity services, at least in France.</p> <p>Technically, I had an Azure AD (Entra ID) created on my customer tenant, and then this account was synced to <b>REDACTED</b> tenant. Note that is this not an Azure AD B2B relationship as there is no SSO here : I had different passwords to connect to my customer account or the <b>REDACTED</b> one. Anyways, thanks to this synchronization, I had access to the incident platform to handle incidents.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_identities-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_identities-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_identities-1400.webp"></source> <img src="/assets/img/BUGBOUNTY/01/bug_bounty_01_identities.png" class="img-fluid rounded imgc" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Before reading the next section, keep in mind is that all identified vulnerabilities require a user account in <b>REDACTED</b>’s tenant. Therefore a limited set of people could exploit those vulnerabilities, which represent around 100,000 user accounts (subcontractors, partners, customers, employees).</p> <hr> <h2 id="security-issues">Security issues</h2> <h4 id="first-case---incident-platform">First case - Incident platform</h4> <p>The first time I accessed the incident platform, I decided to hunt for bugs. The most critical scenario would be to access <b>REDACTED</b> other customers data and see all their security incidents, but (un)fortunately, I wasn’t able to achieve that. After a few minutes, I took a look at my profile and saw that I could access any profile picture with a URL that looked like this : <code>https://incidentplatform.redacted.com/secure/useravatar?ownerId=JIRAUSER12345</code> : a basic IDOR that allowed me to access a vast amount of profile picture (without EXIF data), making <b>REDACTED</b> not GDPR-compliant, since users were not informed that their personal information (their face in that case) would be shared between all <b>REDACTED</b> customers.</p> <h5 id="responsible-disclosure">Responsible disclosure</h5> <table id="custom" class="t-border"> <tr> <th style="text-align:center">Date</th> <th style="text-align:center">Descritpion</th> </tr> <tr> <td style="text-align:center">06/11/2023</td> <td style="text-align:center">Report sent</td> </tr> <tr> <td style="text-align:center">06/11/2023</td> <td style="text-align:center">Report acknowledged</td> </tr> <tr> <td style="text-align:center">30/11/2023</td> <td style="text-align:center">Fixed</td> </tr> </table> <p><br></p> <hr> <h4 id="second-case---integrify">Second case - Integrify</h4> <h5 id="user-enumeration">User enumeration</h5> <p>After writing a short report about the previous issue, I spent a lot of time looking for an appropriate email address such as security@<b>redacted</b>.com, which lead me to use Google dorks. By Google dorking about this company, I found various subdomains and web applications, and I decided to hunt for more bugs! <br> I discovered a subdomain hosting an <a href="https://www.integrify.com" target="_blank" rel="noopener noreferrer">Integrify</a> instance, which is an application dedicated to workflows as far as I can tell. I didn’t try to understand the application business at first, and I simply noticed that a feature allowed me to send messages to people, and thus to search for people in a directory.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_enum_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_enum_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_enum_1-1400.webp"></source> <img src="/assets/img/BUGBOUNTY/01/bug_bounty_01_enum_1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_enum_2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_enum_2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_enum_2-1400.webp"></source> <img src="/assets/img/BUGBOUNTY/01/bug_bounty_01_enum_2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>After some guessing and research, I was able to identify a second API endpoint to enumerate users. I don’t know what’s the difference between the two, but the first one returns <b>94k users</b>, while the second one returns <b>50k users</b>. All of these users are employees, but also partners, subcontractors and customers.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_enum_3-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_enum_3-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_enum_3-1400.webp"></source> <img src="/assets/img/BUGBOUNTY/01/bug_bounty_01_enum_3.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h4 id="documents-enumeration">Documents enumeration</h4> <h5 id="attachments">Attachments</h5> <p>When sending messages to people using the application, it is also possible to attach files. So I started scratching there and intercepting requests. As you can see below, this request looks for comments in a specific <b>instance</b> and returns a JSON object containing our comment and attachment. I don’t know what an instance is, but having a business knowledge of the application was not my goal since I hadn’t much time to spend on it.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_1-1400.webp"></source> <img src="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_2-1400.webp"></source> <img src="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>The JSON doesn’t return any download URL. Instead we only have a SID. In order to get the download URL, we need to use an <a href="https://developer.integrify.com/rest/Files/link" target="_blank" rel="noopener noreferrer">API endpoint</a>, which will redirect to the download URL. As described on the documentation, we need several parameters here :</p> <ul> <li> <code>owner_type</code>, which will always be set to <code>instance</code> </li> <li> <code>owner_sid</code>, which is the instance SID</li> <li> <code>object_type</code>, which will always be set to <code>comment</code> </li> <li> <code>object_sid</code>, which is the file SID</li> </ul> <p>Actually, when clicking on the attachment and intercepting requests, another undocumented API endpoint is used, and behaves the same way, so we have two entry points to retrieve documents.</p> <p>Now that we know how to get attachments, we simply need to get the list of all instances, automate that, and it should work! According to the documentation, there is an <a href="https://developer.integrify.com/rest/Instances/instance-monitor-list" target="_blank" rel="noopener noreferrer">API endpoint</a> that allows to enumerate all instances where the current user has monitor permissions. Let’s see what we get by sending a request to it.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_7-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_7-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_7-1400.webp"></source> <img src="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_7.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>I spent some time reading the documents names (hidden on the picture), and I knew this was juicy stuff. In addition, there is a total of <b>112k instances</b>, so we probably will get many attachments available.</p> <p>I wrote a short script that will iterate over all instances fetch attached files :</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">json</span>

<span class="c1"># Sanitized short list of instances which contains attachments
</span><span class="n">instance_ids</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sh">"</span><span class="s">12345678-1234-1234-1234-123456789012</span><span class="sh">"</span><span class="p">,</span>
    <span class="c1"># ... ,
</span>    <span class="sh">"</span><span class="s">12345678-4321-4321-4321-123456789012</span><span class="sh">"</span>
<span class="p">]</span>

<span class="c1"># Iterate over all instances
</span><span class="k">for</span> <span class="n">instance_id</span> <span class="ow">in</span> <span class="n">instance_ids</span><span class="p">:</span>
    <span class="c1"># Send request and read response
</span>    <span class="n">url</span> <span class="o">=</span> <span class="sh">'</span><span class="s">https://redacted.com/napi/instances/</span><span class="sh">'</span> <span class="o">+</span> <span class="n">instance_id</span> <span class="o">+</span> <span class="sh">'</span><span class="s">/comments/</span><span class="sh">'</span>
    <span class="n">cookies</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">iapi_token</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">access%26oauth_token%3D123456789%26oauth_token_secret%3D00000</span><span class="sh">'</span><span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">)</span>

    <span class="c1"># Just in case
</span>    <span class="k">if</span> <span class="ow">not</span> <span class="sh">"</span><span class="s">AttachmentName</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="c1"># Read JSON response (also possible with response.json())
</span>    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="sh">'</span><span class="s">Items</span><span class="sh">'</span><span class="p">]:</span>
        <span class="c1"># Get data, and jump to next iteration if no attachment, we never know
</span>        <span class="n">subject</span>     <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">Subject</span><span class="sh">'</span><span class="p">]</span>
        <span class="n">date</span>        <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">CommentDate</span><span class="sh">'</span><span class="p">]</span>
        <span class="n">attachments</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">Attachments</span><span class="sh">'</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">attachments</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Iterate over all attachments for a given intsance
</span>        <span class="k">for</span> <span class="n">attachment</span> <span class="ow">in</span> <span class="n">attachments</span><span class="p">:</span>
            <span class="n">name</span>    <span class="o">=</span> <span class="n">attachment</span><span class="p">[</span><span class="sh">'</span><span class="s">AttachmentName</span><span class="sh">'</span><span class="p">]</span>
            <span class="n">sid</span>     <span class="o">=</span> <span class="n">attachment</span><span class="p">[</span><span class="sh">'</span><span class="s">AttachmentSID</span><span class="sh">'</span><span class="p">]</span>

            <span class="c1"># Write CSV to get a summary
</span>            <span class="n">row</span> <span class="o">=</span> <span class="sh">'</span><span class="s">||</span><span class="sh">'</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">instance_id</span><span class="p">),</span> <span class="nf">str</span><span class="p">(</span><span class="n">subject</span><span class="p">),</span> <span class="nf">str</span><span class="p">(</span><span class="n">date</span><span class="p">),</span> <span class="nf">str</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="nf">str</span><span class="p">(</span><span class="n">sid</span><span class="p">))</span>  <span class="o">+</span> <span class="sh">'</span><span class="se">\n</span><span class="sh">'</span>
            <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">attachments_table.csv</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">"</span><span class="s">utf-8</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            
            <span class="c1"># Fetch and store file
</span>            <span class="n">url</span> <span class="o">=</span> <span class="sh">'</span><span class="s">https://redacted.com/rest-service/files/stream/?owner_sid=</span><span class="sh">'</span> <span class="o">+</span> <span class="n">instance_id</span> <span class="o">+</span> <span class="sh">'</span><span class="s">&amp;owner_type=instance&amp;object_sid=</span><span class="sh">'</span> <span class="o">+</span> <span class="n">sid</span> <span class="o">+</span> <span class="sh">'</span><span class="s">&amp;object_type=comment</span><span class="sh">'</span>
            <span class="n">cookies</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">iapi_token</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">access%26oauth_token%3b123456789%26oauth_token_secret%3D00000</span><span class="sh">'</span><span class="p">}</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">)</span>
            
            <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">./ATTACHMENTS/</span><span class="sh">'</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="sh">'</span><span class="s">wb</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">attachment_file</span><span class="p">:</span>
                <span class="n">attachment_file</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">writen</span><span class="sh">"</span><span class="p">)</span></code></pre></figure> <p>I ran this script on only 30 instances, and I retrieved approx. 50 documents (PDFs, XLSXs, MSGs, and DOCXs) which contain business data i.e. customers and partners data.</p> <h5 id="other-documents">Other documents</h5> <p>A last word about documents : according to <a href="https://developer.integrify.com/rest/Files/list" target="_blank" rel="noopener noreferrer">Integrify API documentation</a>, there are attachment, but there are also files associated to an instance that are not attachments. So let’s try to request this endpoint! Long story short : we simply have the opportunity to download more and more files.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_9-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_9-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_9-1400.webp"></source> <img src="/assets/img/BUGBOUNTY/01/bug_bounty_01_attachments_9.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h5 id="responsible-disclosure-1">Responsible disclosure</h5> <table id="custom" class="t-border"> <tr> <th style="text-align:center">Date</th> <th style="text-align:center">Descritpion</th> </tr> <tr> <td style="text-align:center">4/12/2023</td> <td style="text-align:center">Report about user enumeration sent</td> </tr> <tr> <td style="text-align:center">12/12/2023</td> <td style="text-align:center">No answer, follow up</td> </tr> <tr> <td style="text-align:center">30/04/2024</td> <td style="text-align:center">No answer, follow up</td> </tr> <tr> <td style="text-align:center">24/05/2024</td> <td style="text-align:center">No answer, follow up and adding report about documents enumeration</td> </tr> <tr> <td style="text-align:center">31/06/2024</td> <td style="text-align:center">No answer, follow up</td> </tr> </table> <p><br></p> <hr> <h4 id="third-case---azure">Third case - Azure</h4> <p>At this point I was still trying to find an email address to send my report, but again I discovered a subdomain with a directory listing, and I decided to hunt for more bugs. The root directory contained approximately ten directories with only a few that I could access. All the content was identity-related, with folders and files named like SSO, SAML and so on. One of the directories contained a whole C# project folder, including only compiled files :</p> <ul> <li>https://identity.redacted.com/Folder1/obj/Release/renamed.dll</li> <li>https://identity.redacted.com/Folder1/obj/Debug/renamed_debug.dll</li> </ul> <p>I began to look for strings inside the DLL to understand what it is used for, and when parsing printable characters only, I ended up with a string corresponding to Azure AD (Entra ID) Service Principal credentials that are still valid <i>i.e.</i> a tenant ID, a client ID (or application ID) and of course a secret. <br> I used Azure CLI to connect to the service principal using the command below, and started recon on Azure. <br> <code>az login --service-principal -u '1234abcd-1234-1234-1234-1234abcd1234' -p 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxqWQ==' --tenant '1234abcd-4321-4321-4321-1234abcd1234' --allow-no-subscriptions</code></p> <p>The service principal was related to a web application that was not accessible, either because of network filtering or because it was retired. Thus, I was not able to do much with it : no subscription available and no directory permissions. The only exploit would be to interact with the web application, but as mentioned, it was not accessible.</p> <h5 id="responsible-disclosure-2">Responsible disclosure</h5> <p>For the third case, I don’t remember when I observe that all was properly fixed.</p> <table id="custom" class="t-border"> <tr> <th style="text-align:center">Date</th> <th style="text-align:center">Descritpion</th> </tr> <tr> <td style="text-align:center">06/11/2023</td> <td style="text-align:center">Report sent</td> </tr> <tr> <td style="text-align:center">06/11/2023</td> <td style="text-align:center">Report acknowledged</td> </tr> <tr> <td style="text-align:center">30/11/2023</td> <td style="text-align:center">Follow up because not properly fixed</td> </tr> <tr> <td style="text-align:center">Now</td> <td style="text-align:center">Fixed</td> </tr> </table> <hr> <h2 id="conclusion">Conclusion</h2> <p>So what happened? A security company that proposes SOC services “invited” thousands of users in their directory (including me), giving them access to confidential information about other customers, which are not cybersecurity-related, but probably even more confidential. This is how Identity and Access Management (IAM) is important!</p> <p><i>Thanks for reading.</i></p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 CyberIntruder - Molx32 . </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-MFVVRMM3DK"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-MFVVRMM3DK");</script> </body> </html>