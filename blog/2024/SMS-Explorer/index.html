<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> CyberIntruder | Blog </title> <meta name="author" content="CyberIntruder - Molx32 "/> <meta name="description" content="This article explores the security risks posed by Public SMS Services, where shared virtual phone numbers allow users to read each other's messages. Through real-world examples, it highlights the potential for data exposure and unauthorized access to sensitive information, underscoring the dangers of using these services for verification and authentication."/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://cyber-intruder.com/blog/2024/SMS-Explorer/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://cyber-intruder.com/">CyberIntruder</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/about">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/fr-fr/blog/2024/SMS-Explorer/"> FR-FR </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">The hidden risks of public SMS services - How your messages are being exposed</h1> <p class="post-meta">September 20, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fas fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/SMSExplorer"> <i class="fas fa-hashtag fa-sm"></i> SMSExplorer</a>   </p> </header> <article class="post-content"> <p><i>I recently needed to register on an web application, but I didn’t want to provide my real phone number, so I used a temporary phone number to receive a validation SMS. To achieve this, I took a look at those websites proposing free phone numbers to receive SMSs, visible by anyone: this is what I call <b>Public SMS Services (PSSs)</b>. The reason I decided to investigate PSSs is that their content may be useful from both a Cyber-Threat Intelligence (CTI) and Open-Source Intelligence (OSINT) perspective, and even Offensive Security (OffSec).</i></p> <hr> <h4 id="plan">Plan</h4> <ul> <li><a href="#introduction">Introduction</a></li> <li><a href="#automation">Automation</a></li> <li><a href="#results">Results</a></li> <li><a href="#conclusion">Conclusion</a></li> </ul> <hr> <h2 id="introduction">Introduction</h2> <p>A really quick word about existing reasearch on this topic : the only source I could find is from the Canadian ZATAZ that <a href="https://www.zataz.com/osint-comment-lire-les-sms-dinconnus/" target="_blank" rel="noopener noreferrer">published a short post about Public SMS Services</a>.</p> <h4 id="what-are-public-sms-services">What are Public SMS Services?</h4> <p>While browsing the Internet, you probably searched for a temporary email address at least once. For example, you created a user account on some web app, and you didn’t want to provide real information. In the same way, you may need a temporary phone number if the app requires it: in this case, you probably used a <b>virtual phone number</b>, which allows you to receive a confirmation SMS or so, in order to validate your registration on the concerned web app. Although this use case is quite simple, let’s give a proper definition of what I call <b>SMS services</b>.</p> <blockquote> <p>A <b>SMS Service</b> is an online service that provides virtual phone numbers to their customers in order to receive SMSs. If a service provides additional services, such as VoIP, it will still be considered a SMS Service.</p> </blockquote> <p>There are plenty of such services out there. Using any simple online research such as <a href="https://letmegooglethat.com/?q=receive+sms+online" target="_blank" rel="noopener noreferrer">receive sms online</a> using your favorite search engine will lead you to multiple websites.</p> <h4 id="an-example">An example</h4> <p>Let’s take an example real quick and have a look at <a href="https://smstome.com" target="_blank" rel="noopener noreferrer">https://smstome.com</a>. Just select a phone number : congratulation, you can read all messages received.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_intro_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_intro_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_intro_1-1400.webp"></source> <img src="/assets/img/publicsms_intro_1.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_intro_2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_intro_2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_intro_2-1400.webp"></source> <img src="/assets/img/publicsms_intro_2.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>If you want to do some testing, simply try to register on a web app that requires a phone number, and check if you receive a verification SMS. Actually it might not work, because after some time, those phone numbers are considered malicious or suspicious by carriers and applications. To ensure the service is still available, SMS service providers simply retire old phone numbers and replace them with new ones.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_intro_3-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_intro_3-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_intro_3-1400.webp"></source> <img src="/assets/img/publicsms_intro_3.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>You may notice that some messages seem truncated, and they actually are. I don’t know why, but this is a common issue shared by many SMS services, which maybe need to optimize their data storage, especially for free services.</p> <h4 id="security-issue">Security issue</h4> <p>When looking at these services, we can see that some are billed, others are free. There are two main differences between the two :</p> <ul> <li> <p><b>Privacy</b> - For users looking for privacy, free services are prefered because they don't require users to create an account, while paid services require to do so <i>i.e.</i> require users to provide personal information.</p> </li> <li> <p><b>Access control</b> - When subscribing to a paid service, virtual phone numbers are private <i>i.e.</i> a user can have multiple virtual phone numbers, but a virtual phone number can be owned only by one user. However with free services there is no form of access control, and virtual phone numbers can be shared, so are SMSs.</p> </li> </ul> <p>Obviously, the only thing we can exploit here is free SMS services, that I will now call <b>Public SMS Services (PSS)</b>, which is not an official term.</p> <blockquote> <p style="margin-top:none;">A <b>Public SMS Service (PSS)</b> is a SMS Service that do not provide any access control mechanism, and allows multiple users to share the same virtual phone numbers, and thus allows users to read each other messages.</p> </blockquote> <p>Here is a quick summary of the different SMS Services categories.</p> <table id="custom" class="t-border"> <caption style="text-align:center"><b>SMS Services categories</b></caption> <tr> <th>Target</th> <th>Categories</th> <th>Privacy</th> <th>Access control</th> </tr> <tr> <td>Paid services</td> <td>These are services that allow customers to pay for a virtual phone numbers, usually to send and receive SMSs. With such services, a phone number will be dedicated to only one user, which means access control is implemented, which is good. However, this also implies that users need to create an account, which doesn't help with privacy.</td> <td style="text-align:center">❌</td> <td style="text-align:center">✅</td> </tr> <tr> <td>Registered services</td> <td>These are services that allow customers to get a virtual phone number only if they create an account. Again, access control can be implemented but the account creation is not privacy friendly.</td> <td style="text-align:center">❌</td> <td style="text-align:center">⚠️</td> </tr> <tr> <td>Free services</td> <td>These are the services that are freely accessible without any form of authentication. Here, a phone number will not be dedicated to only one user, which is not compatible with access control.</td> <td style="text-align:center">✅</td> <td style="text-align:center">❌</td> </tr> </table> <p>Before digging those services, here is a scheme representing our study scope. As you can see, I only studied SMS received on <a href="https://receive-smss.com/" target="_blank" rel="noopener noreferrer">https://receive-smss.com/</a>, which is a public and free SMS service. I decided to focus only this data source because it was pretty simple to automate data collection, but also because this web sites received a lot of messages.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_intro_0-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_intro_0-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_intro_0-1400.webp"></source> <img src="/assets/img/publicsms_intro_0.png" class="img-fluid rounded imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h4 id="exploiting-the-security-issue">Exploiting the security issue</h4> <p>You may wonder why would anyone spend their time reading strangers SMS. Well, let me give an example: while refreshing a “received messages” web page on a PSS to see the message I was waiting for, I took a look at already received messages, and one of them was something like the following: <code>Hi redacted@gmail.com, your new access code is 458953. You can now connect on https://REDACTED.com.</code>.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_intro_1.gif-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_intro_1.gif-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_intro_1.gif-1400.webp"></source> <img src="/assets/img/publicsms_intro_1.gif" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Since I couldn’t believe it, I quickly configured an anonymization pipeline and accessed the account. The website was a cryptocurrency application that allowed users to access their different wallets. I had access to personal information and to a significative amount of 65 Bitcoins.</p> <p>Besides the message received that represented itself a flaw, I had three hypothesis in mind:</p> <ol> <li> <b>This is a human mistake</b> – The person owning the account used a Public SMS Service ignoring what the consequences could be.</li> <li> <b>This is a development environment</b> – In this case, the account is not a real one, or at least this is a test account, with mocking data.</li> <li> <b>This is some kind of aggressive honeypot</b> – Since the message is received on an PSS, and that it leaks the three key information needed to access the account (website, username and password), it seemed too obvious not to be a honeypot.</li> </ol> <p>In the end, the domain was created three months ago, and all features were not implemented yet, so it probably was a development environment.</p> <p><br> <br></p> <p>Altough this is a quite simple use case, let’s define some kind of attack model. We have two major use cases which are SMSs without URL, and SMSs with URL.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_security_gif_1.gif-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_security_gif_1.gif-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_security_gif_1.gif-1400.webp"></source> <img src="/assets/img/publicsms_security_gif_1.gif" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h6 id="case-1---sms-without-url">Case 1 - SMS without URL</h6> <p>In this first case, <code>User A</code> gets a virtual phone number from a PSS, they use this phone number to register on a web application that will store all user-related data into its database. At some point, the application will be triggered to send a SMS, for instance to invite the user to come back to the app : <code>Hey John DOE, you have a new offer on your house located at Av. de Cointe 5, 4000 Liège, Belgium!</code>. The SMS will be sent to the phone number associated to <code>User A</code> and thus sent to the PSS.</p> <p>Now, if a malicious <code>User B</code> spends their time watching SMSs on the PSS, they could read PII, which is the equivalent of an indirect read access to the application database. Alternatively, the SMS may also contain some PIN or password that can be used to authenticate on an app with the phone number as a user ID. In this case, <code>User B</code> could compromise the account, and have an indirect read/write access to <code>User A</code> information.</p> <h6 id="case-2---sms-with-url">Case 2 - SMS with URL</h6> <p>In this second case, <code>User A</code> gets a virtual phone number from a PSS, they use this phone number to register on a web application that will store all user-related data into its database. At some point, the application will be triggered to send a SMS, for example <code>Hey John DOE, you have a new match, send them a message : https://findamatch.com/messages?token=eyf652s4fz6e621sdf65z4szdfzrgzd62x1fz6ver5g1</code>. The SMS will be sent to the phone number associated to <code>User A</code> and thus sent to the PSS.</p> <p>Now, if a malicious <code>User B</code> spends their time to watch SMSs on the PSS, they could navigate to the URL, and either reset a password, or directly compromise <code>User A</code> account, and have an indirect read/write access to <code>User A</code> information.</p> <p><br></p> <h4 id="regulatory-compliance">Regulatory compliance</h4> <h5 id="gdpr">GDPR</h5> <p>If you see a message containing personal information, this may not be <a href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32016R0679" target="_blank" rel="noopener noreferrer">GDPR</a> compliant because of the Article 32 that says the following. <i></i></p> <blockquote> <p>[…] the controller and the processor shall implement appropriate technical and organisational measures to ensure a level of security appropriate to the risk, including inter alia as appropriate:</p> <ul> <li><b>(a) the pseudonymisation and encryption of personal data;</b></li> <li>(b) the ability to ensure the ongoing confidentiality, integrity, availability and resilience of processing systems and services;</li> <li>(c) the ability to restore the availability and access to personal data in a timely manner in the event of a physical or technical incident;</li> <li>(d) a process for regularly testing, assessing and evaluating the effectiveness of technical and organisational measures for ensuring the security of the processing. &lt;/i&gt;</li> </ul> </blockquote> <p>From the <b>PSS point of view</b>, data is simply received and displayed as is. We can compare it to a forum where users can post anything they want, but here users are actually <b>senders</b>. From the <b>senders</b> point of view, the <b>end user</b> is supposed to provide real information. Based on that assumption, the sender will trust the provided phone number and assume it is private. Finally, the <b>end user</b> is informed that a real information is expected, and that PSS will publish SMS associated to the app. The problem is that the end user doesn’t know when SMS will be sent (except for password reset and verification), and what the content will be.</p> <h5 id="electronic-communications-privacy-act">Electronic Communications Privacy Act</h5> <p><br></p> <h4 id="a-few-insights">A few insights</h4> <p>In order to get some information about the interest in PSSs, we can use any trend analysis tool. Here are my results for keywords <code>free sms online</code> on <a href="https://semrush.com" target="_blank" rel="noopener noreferrer">https://semrush.com</a>. We can see in the bottom right corner that these keywords belong to a cluster where users seem to look for test or verification phone number. This already give insight about data we will find. Additionally, we can take a specific domain to analyze its traffic and see how it is used, which may be useful in order to select a high traffic PSS for analysis.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_intro_4-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_intro_4-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_intro_4-1400.webp"></source> <img src="/assets/img/publicsms_intro_4.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p><br> After a few week of SMS collection on <a href="https://receive-smss.com/" target="_blank" rel="noopener noreferrer">https://receive-smss.com/</a>, we can observe that the number of messages received on a hourly basis approaches 2000 SMS/h.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_stats_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_stats_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_stats_1-1400.webp"></source> <img src="/assets/img/publicsms_stats_1.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p><br> Then, we can observe how phone numbers are used based on their countries. This is only an approximation because phone are periodically retired and replaced by new ones, not necessarily from the same country. What we can see on the following chart is the number of message receive for each country. <br> Then, if we divide this total by the number of phones belonging to that country, we get the mean number of messages received by phone by country, which is in other terms how frequently a phone will receive messages. We can see that Indian phone numbers are the most active with <b>47801</b> total messages received on the <b>7 last days</b>, with only two phone numbers available, while UK received <b>82937</b> with <b>14</b> phone numbers available.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_stats_2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_stats_2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_stats_2-1400.webp"></source> <img src="/assets/img/publicsms_stats_2.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_stats_2.1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_stats_2.1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_stats_2.1-1400.webp"></source> <img src="/assets/img/publicsms_stats_2.1.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p><br> Besides the amount of received message, the most valuable type of SMS are the ones that contain URL. The following chart shows the number of message containing URLs received per hour, which approches <b>49 SMS/h</b>, which which is <b>2.45%</b> of the total <b>2000 SMS/h</b>. Alternatively, if we take a look at the total of messages received over the <b>last 14 days</b>, this is approx. <b>2.49%</b> of messages containing URLs. But don’t be fooled, this doesn’t mean that <b>2.49%</b> of messages received are interesting : actually most messages containg URL are spams, ads, or are incomplete messages. That’s why we need AUTOMATION!</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_stats_3-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_stats_3-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_stats_3-1400.webp"></source> <img src="/assets/img/publicsms_stats_3.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_stats_4-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_stats_4-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_stats_4-1400.webp"></source> <img src="/assets/img/publicsms_stats_4.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p><br> <br></p> <hr> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_automation_1_gif.gif-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_automation_1_gif.gif-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_automation_1_gif.gif-1400.webp"></source> <img src="/assets/img/publicsms_automation_1_gif.gif" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h2 id="automation">Automation</h2> <h4 id="why">Why?</h4> <p>My primary need was to collect data and store it in a database, becauses the source data source I rely on only provides the last 40 SMS received. Then, I needed to develop a searching feature that would allow to identify interesting patterns <i>e.g.</i> messages with PII. Finally, once patterns are identified, a last feature was needed to exploit them.</p> <h4 id="how">How?</h4> <h5 id="first-approach">First approach</h5> <p>I developed a first very basic version of the solution. It parses <a href="https://receive-smss.com/" target="_blank" rel="noopener noreferrer">https://receive-smss.com/</a> and stores any unique SMS identified. After a few hours spent collecting SMSs, I was excited to analyze the data, and I quickly figured out that there were two interesting cases.</p> <ul> <li>The first one is when messages directly contain sensitive data, like credentials or PII. However, this is a very rare case, and it is complex to automate without false positive, and I didn’t want to deal with false positive at this point.</li> <li>The second one is when messages contain URLs. This is a much more frequent case, and it represents a huge part of interesting messages. Why? Because anything can hide behind a URL, a scam or an account compromise.</li> </ul> <p>I abandoned the first case and focused on messages that contain URLs.</p> <h5 id="improvements">Improvements</h5> <p>To make the analysis a bit simpler, I developed a web interface where I can look for messages collected, and easily navigate to URLs. Thanks to this tiny improvement, I built a list of all URLs and I manually navigated to each one of them, and some of them simply gave me access to user accounts. Thus, I decided to develop the last core feature: the <b>aggressive mode</b>. This can be turned on to navigate to URLs known to hide interesting data, then it will add this data to the database!</p> <p>However, I faced a challenge that is still not resolved: <b>race conditions</b>. Some URLs, such as password reset URLs, have either an expiration date, or can be accessed only once to prevent someone else to reset a password a second time. I decided not to focus on that problem for now, because there are a lot of URLs to explore.</p> <h5 id="architecture">Architecture</h5> <p>The whole architecture is made of Docker containers. The entry point from the user perspective is the <b>Flask</b> web server. Its role is to render and serve web pages, and to enqueue different jobs in a <b>Redis queue</b>:</p> <ul> <li>A job that will initialize various things</li> <li>A job that will collect messages (infinite loop)</li> <li>A job that will collect data, only in aggressive mode (infinite loop)</li> </ul> <p>These jobs will be executed by two <b>workers</b>. Finally, we have a database with SMSs, targets, configuration, and so on.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_automation_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_automation_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_automation_1-1400.webp"></source> <img src="/assets/img/publicsms_automation_1.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h5 id="latest-release">Latest release</h5> <p>Aggressive mode is great to collect data, but the issue is that each domain must be parsed differently to retrieve data. To resolve this, I created a parent class named <b>DataModule</b> with several generic methods that will used by different children classes.</p> <p>Let me explain a practical example: in multiple cases, data can be retrieved simply by reading the <b>Location</b> header of a <b>HTTP 302 Redirect</b>, which directly contains data. Thus, I wrote a method for the DataModule class named <b>_retrieve_data_redirect()</b> that simply return data found in the location header. Now, when I want to add a new parser for a given domain, I simply need to call this method, which makes the parser very simple to implement <i>c.f.</i> complete class for REDACTED parser below.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">REDACTED</span><span class="p">(</span><span class="n">DataModule</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">name</span>        <span class="o">=</span> <span class="sh">'</span><span class="s">REDACTED</span><span class="sh">'</span>
        <span class="n">base_url</span>    <span class="o">=</span> <span class="sh">'</span><span class="s">https://nps.REDACTED.in/</span><span class="sh">'</span>
        <span class="nf">super</span><span class="p">().</span><span class="nf">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">base_url</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">retrieve_data</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">_retrieve_data_redirect</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></code></pre></figure> <hr> <h4 id="limitations">Limitations</h4> <h5 id="smss-sources">SMSs sources</h5> <p>As previously mentioned, the only SMS source is <a href="https://receive-smss.com/" target="_blank" rel="noopener noreferrer">https://receive-smss.com/</a>. At some point, additional SMS sources may be needed for this tool to handle more data. I didn’t plan to work on that yet.</p> <h5 id="data-collection">Data collection</h5> <p>Again, as mentioned before, data collection is limited in multiple ways :</p> <ul> <li>Race conditions, which happens to be a problem when the URL expires, or when the URL can be accessed only once.</li> <li>Requests rate limiting, which causes the targeted server to return a <code>HTTP 429 Too Many Requests</code> and prevents us to parse additional data for a few seconds or minutes.</li> <li>Other security controls, that may be related to users agents, locations, and so on.</li> <li>Sometimes, URLs can be accessed only from the corresponding mobile application. In some cases, the HTTP response prevents access and does not provide any useful data. In some other cases, this behavior may be bypassed by changing the user agent.</li> </ul> <hr> <h2 id="results">Results</h2> <p>Now is the time to finally talk about cybersecurity, OSINT, CTI, and OffSec! This section describes the different use cases I encountered while analyzing hundreds of thousands of SMS. For each use case, I tried to dig as deeper as I could to provide a real world impact analysis.</p> <table id="custom" class="t-border"> <caption style="text-align:center"><b>Cybersecurity fields</b></caption> <tr> <th>Field</th> <th>Why is it useful?</th> </tr> <tr> <td>OSINT</td> <td>This may be the most useful usecase since a lot of user accounts can be identified, associated to a location, an email address, a physical address, and so on.</td> </tr> <tr> <td>CTI</td> <td>This is only useful when a company account can be tagged as compromised and then handled by security teams.</td> </tr> <tr> <td>Offensive Security</td> <td>This is only useful when a company account can be compromised, rather than a personnal account such as Instagram.</td> </tr> </table> <p>Also, from an attacker perspective, all the presented results are <b>opportunistic</b>, which means the attacker is not able to choose its target and entirely relies on which account or data URLs may redirect to.</p> <h3 id="use-cases">Use cases</h3> <p>The following table shows the different use cases encountered.</p> <table id="custom" class="t-border"> <caption style="text-align:center"><b>SMS security qualification</b></caption> <tr> <th>Use case</th> <th>Description</th> <th>Application</th> </tr> <tr> <td> <a href="#password-reset-urls">Password reset URLs</a> </td> <td>Account compromise by setting a new password</td> <td>CTI, OffSec, OSINT</td> </tr> <tr> <td><a href="#bypass-access-control">Bypass access control</a></td> <td>Account compromise by doing nothing</td> <td>CTI, OffSec, OSINT</td> </tr> <tr> <td><a href="#data-exposure">Data exposure</a></td> <td>Allows users to gather information without compromising any account.</td> <td>CTI, OffSec, OSINT</td> </tr> <tr> <td><a href="#data-discovery">Data discovery</a></td> <td>Allows users to gather information about a specific target <i>e.g.</i> subdomain discovery.</td> <td>CTI, OffSec, OSINT</td> </tr> <tr> <td><a href="#missed-opportunities">Missed opportunities</a></td> <td>URLs that can't be exploited, mainly because they are truncated.</td> <td>-</td> </tr> <tr> <td><a href="#scams">Scams</a></td> <td>URLs that lead to explicit scam <i>e.g.</i> fake UPS website.</td> <td>-</td> </tr> </table> <h6 id="password-reset-urls">Password reset URLs</h6> <p>This use case is very simple and common: the message received contains a password reset URL as shown below.</p> <blockquote> <p><i>You can reset your password by clicking on this link: <a href="https://pprod.mycompany.com/account?reset-token=RANDOM_GUID" target="_blank" rel="noopener noreferrer">https://pprod.mycompany.com/account?reset-token=RANDOM_GUID</a></i></p> </blockquote> <h6 id="bypass-access-control">Bypass access control</h6> <p>This scenario is even simpler, and simply gives access as an authenticated user when clicking on the URL. For example:</p> <blockquote> <p><i>Click here to access your account : <a href="https://shrtn.com/0123456789abcdefgh" target="_blank" rel="noopener noreferrer">https://shrtn.com/0123456789abcdefgh</a></i></p> </blockquote> <h6 id="data-exposure">Data exposure</h6> <p>While this scenario is not as critical as the previous ones, it gives the opportuniy to collect various types of data, base on the concerned application business.</p> <blockquote> <p><i>Click here to check your analysis results : <a href="https://shrtn.com/0123456789abcdefgh" target="_blank" rel="noopener noreferrer">https://shrtn.com/0123456789abcdefgh</a></i></p> </blockquote> <h6 id="data-discovery">Data discovery</h6> <p>This scenario is very rare and not very sensitive. The only example is the enumeration of subdomains, where the URL is not accessible <i>i.e.</i> does not lead to account compromise from the public Internet. For example :</p> <blockquote> <p><i>Hello admin, click on the URL to reset your password : <a href="https://internal.and.sensitive.domain.com/0123456789abcdefgh" target="_blank" rel="noopener noreferrer">https://internal.and.sensitive.domain.com/0123456789abcdefgh</a></i></p> </blockquote> <h6 id="scams">Scams</h6> <p>Among all messages, many are scams that look like this.</p> <blockquote> <p><i>Your shipment could not be delivered because the transport fee was not paid. Click here to pay.</i></p> </blockquote> <h6 id="missed-opportunities">Missed opportunities</h6> <p>Missed opportunities are almost exclusively use cases where the whole URL can’t be read, because it is too long. For example :</p> <blockquote> <p><i>Hi, how are you? Did you ask for a password reset? Here is your URL, don’t share it! <a href="https://superlongandweirddomainnamerightquestionmark.com/?reset=A" target="_blank" rel="noopener noreferrer">https://superlongandweirddomainnamerightquestionmark.com/?reset=A</a> </i></p> </blockquote> <h3 id="statistics">Statistics</h3> <p>Statictics must be added.</p> <h3 id="real-world-examples">Real world examples</h3> <table id="custom" class="t-border"> <caption style="text-align:center"><b>Resource deployed</b></caption> <tr> <th>Target</th> <th>#</th> <th>Password reset</th> <th>Bypass access control</th> <th>Data exposure</th> <th>Data discovery</th> <th>Scams identification</th> <th>Missed opportunities</th> </tr> <tr> <td><a href="#venmo">Venmo</a></td> <td style="text-align:center">N/A</td> <td style="text-align:center">✅</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> </tr> <tr> <td><a href="#instagram">Instagram</a></td> <td style="text-align:center">1200/month</td> <td style="text-align:center">✅</td> <td style="text-align:center">✅</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> </tr> <tr> <td><a href="#biedronka">Biedronka</a></td> <td style="text-align:center">N/A</td> <td style="text-align:center">✅</td> <td style="text-align:center">✅</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> </tr> <tr> <td><a href="#job-logic">Job logic</a></td> <td style="text-align:center">N/A</td> <td style="text-align:center">❌</td> <td style="text-align:center">✅</td> <td style="text-align:center">✅</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> </tr> <tr> <td><a href="#free-ads">Free ads</a></td> <td style="text-align:center">N/A</td> <td style="text-align:center">❌</td> <td style="text-align:center">✅</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> </tr> <tr> <td><a href="#airindia">AirIndia</a></td> <td style="text-align:center">1500/month</td> <td style="text-align:center">✅</td> <td style="text-align:center">✅</td> <td style="text-align:center">✅</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> </tr> <tr> <td><a href="#elilly">e.lilly</a></td> <td style="text-align:center">75/month</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">✅</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> </tr> <tr> <td><a href="#texts-from-my-ex">Texts from my ex</a></td> <td style="text-align:center">N/A</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">✅</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> </tr> <tr> <td><a href="#stickermule">Stickermule</a></td> <td style="text-align:center">N/A</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">✅</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> </tr> <tr> <td><a href="#abinitio-solutions">Abinitio Solutions</a></td> <td style="text-align:center">N/A</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">✅</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> </tr> <tr> <td><a href="#communidad-madrid">Communidad Madrid</a></td> <td style="text-align:center">N/A</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">✅</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> </tr> <tr> <td><a href="#ups-scam">UPS Scam</a></td> <td style="text-align:center">N/A</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">✅</td> <td style="text-align:center">❌</td> </tr> <tr> <td><a href="#payfone">Payfone</a></td> <td style="text-align:center">N/A</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">✅</td> </tr> <tr> <td><a href="#validahealth">Validahealth</a></td> <td style="text-align:center">N/A</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">✅</td> </tr> <tr> <td><a href="#experian">Experian</a></td> <td style="text-align:center">N/A</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">❌</td> <td style="text-align:center">✅</td> </tr> </table> <hr> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_1.gif-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_1.gif-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_1.gif-1400.webp"></source> <img src="/assets/img/publicsms_results_1.gif" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <hr> <h5 id="venmo">Venmo</h5> <p>According to Wikipedia, Venmo is an american company owned by PayPal with approximately 70 millions users in 2021. This is some sort of banking application that allows users to send payment to their friends and to manage their business revenues, which makes it a sensitive business application. There is only one message pattern sent from Venmo to its users, and it looks like this.</p> <blockquote> <p><i>Reset your Venmo password: <a href="https://venmo.com/account/password-new?utm_medium=phone&amp;reset_key=40b11eeecc001f5a6d2cc4f40eae408c7bc953f11478eb028032c4f86" target="_blank" rel="noopener noreferrer">https://venmo.com/account/password-new?utm_medium=phone&amp;reset_key=40b11eeecc001f5a6d2cc4f40eae408c7bc953f11478eb028032c4f86</a></i></p> </blockquote> <p>When navigating to the URL, no other information than just setting a password. In this case, an attacker could reset the password and then what?</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_venmo_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_venmo_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_venmo_1-1400.webp"></source> <img src="/assets/img/publicsms_results_venmo_1.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h6 id="impact">Impact</h6> <p>Well, as you can see on the picture, the phone number can be used as the identifier to login into the application.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_venmo_2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_venmo_2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_venmo_2-1400.webp"></source> <img src="/assets/img/publicsms_results_venmo_2.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>This scenario typically involves a <b>race condition</b> for the attacker to compromise the account, because the link may expire, and because the legitimate user may reset their password before the attacker does. Also, when the link expires, it is still possible to navigate to the URL and set up a password. Obviously this won’t work, but it is a waste of time from an attacker perspective.</p> <h6 id="responsible-disclosure">Responsible disclosure</h6> <p>02/05/2024 - Issue reported.</p> <p><a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h5 id="instagram">Instagram</h5> <p>Instagram is very similar to <a href="#venmo">Venmo</a>, which seems very exciting at first glance. I detected this simply because there were a lot of Instagram shorten URLs <i>e.g.</i> <a href="https://ig.me/0123456789abcdef" target="_blank" rel="noopener noreferrer">https://ig.me/0123456789abcdef</a>. This kind of URL is not necessarily sensitive and may for instance redirect to a simple public picture hosted on <a href="https://instagram.com/" target="_blank" rel="noopener noreferrer">https://instagram.com/</a>. You can use a simple Google dork like <code>site:ig.me</code> to get shorten URLs and get redirected to any kind of Instagram content.</p> <p>About Instagram SMS collected, navigating to those URLs would redirect to an Instagram error page displaying something like <i>The URL has expired</i>. I needed to dig deeper, created an Instagram account, and triggered a password reset procedure using a temporary phone number. Then, I was able to confirm that these URLs would allow an opportunistic account compromise. The text messages received look like these.</p> <ul> <li><code>Tap to reset your Instagram password: <a href="https://ig.me/1ZZOeHuLUwa4Ttq" target="_blank" rel="noopener noreferrer">https://ig.me/1ZZOeHuLUwa4Ttq</a></code></li> <li><code>Instagram link: <a href="https://ig.me/r6LPOYK87HRyT73" target="_blank" rel="noopener noreferrer">https://ig.me/r6LPOYK87HRyT73</a>. Don't share it.</code></li> </ul> <p><br></p> <p>When navigating to those URLs, and based on the message pattern received, we are redirected to different web pages.</p> <h6 id="redirection---first-case">Redirection - First case</h6> <p>In the first case, we can just skip the password reset and be logged in as the user <i>i.e.</i> the URL gives direct access to the account. I actually rarely saw this behavior and I have no screenshot for now.</p> <h6 id="redirection---second-case">Redirection - Second case</h6> <p>In the second case, we must complete the password reset procedure, and then authenticate to the account with the phone number and password just set.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_instagram_2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_instagram_2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_instagram_2-1400.webp"></source> <img src="/assets/img/publicsms_results_instagram_2.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h6 id="redirection---third-case">Redirection - Third case</h6> <p>In the third case, the account is locked, but we can still retrieve the username, either by analysing source code or by clicking on the top right menu icon. This may be used for OSINT and CTI.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_instagram_3-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_instagram_3-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_instagram_3-1400.webp"></source> <img src="/assets/img/publicsms_results_instagram_3.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_instagram_4-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_instagram_4-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_instagram_4-1400.webp"></source> <img src="/assets/img/publicsms_results_instagram_4.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h6 id="redirection---fourth-case">Redirection - Fourth case</h6> <p>In the fourth case, the URL has expired or was used.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_instagram_5-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_instagram_5-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_instagram_5-1400.webp"></source> <img src="/assets/img/publicsms_results_instagram_5.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p><br></p> <h6 id="impact-1">Impact</h6> <p>A common intuition would be that one Instagram account is associated with one phone number. Thus, if a Public SMS Service provides a hundred phone numbers, an attacker could only compromise a maximum of a hundred user accounts. Actually, this is wrong. I observed that for a given phone number, multiple Instagram password reset URLs were received, leading to different user accounts. This seemed irrelevant to me. After some testing, I observed that it is <b>not possible to register</b> a new Instagram account with a phone number <b>when the phone number is already used</b> by an existing account. However, it is possible to <b>edit</b> the contact information to add a phone number.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_instagram_6-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_instagram_6-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_instagram_6-1400.webp"></source> <img src="/assets/img/publicsms_results_instagram_6.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Imagine that Instagram has a user <code>jdoe@email.com</code> registered with <code>+4591457271</code>. If this user triggers a password reset, a text message will be received on the Public SMS Service hosting this phone number, and the account could be stolen. Now, imagine that a new user creates a new account with an email address <code>leoagata@proton.me</code>, and then edit their contact information and set their phone number to <code>+4591457271</code>. The immediate consequence is that this phone number will be removed from <code>jdoe@email.com</code> account. Now, if <code>leoagata@proton.me</code> triggers a password reset, a text message will be received on the Public SMS Service hosting this phone number. This means that we can receive multiple passwords reset URLs from different user accounts on the same phone number. The following example shows two SMSs received in a 10 min timeframe, with two different URLs leading to two different user accounts, received on the same phone number.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_instagram_7-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_instagram_7-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_instagram_7-1400.webp"></source> <img src="/assets/img/publicsms_results_instagram_7.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>In the end, it is not possible to create an Instagram account with those virtual phone number, because all of them are already used. This makes Instagram account compromise possible in a very specific case where a user edits its information to provide one of those virtual phone numbers, then triggers a password reset. This would probably lead to testing accounts compromise only.</p> <h6 id="responsible-disclosure-1">Responsible disclosure</h6> <p>When reporting this behavior to Instagram, I was told that Instagram won’t do anything about those phone numbers, although it would be very simple to implement a blacklist feature in my opinion.</p> <p><a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h5 id="biedronka">Biedronka</h5> <p>According to Wikipedia, Biedronka is the largest chain of discount shops in Poland, with 70,000 employees and a nice 11B€ revenue in 2019. Messages received from Biedronka look like this.</p> <ul> <li><code>Link do zmiany hasła https://bdr.page.link/S8CpNMGEgdUjL41B6 ważny 5 minut</code></li> </ul> <p>Yes this is Polish, and it means <code>Link to change password https://bdr.page.link/S8CpNMGEgdUjL41B6 valid 5 minutes</code>. If you’re not familiar with <code>page.link</code>, this is a Google Firebase feature that was designed a few years ago to set up easy to share URLs that handle redirections (see <a href="https://firebase.google.com/docs/dynamic-links/create-manually" target="_blank" rel="noopener noreferrer">Google documentation</a> for more details).</p> <p>Anyways, navigating to the URL would lead this page, inviting user to reset their password, and of course we are able to login with the phone number and password we just set.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_biedronka_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_biedronka_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_biedronka_1-1400.webp"></source> <img src="/assets/img/publicsms_results_biedronka_1.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Another way to compromise a user account is simply to download the mobile app, and enter the targeted public virtual phone number. Then a message is received on the Public SMS Service hosting that virtual phone number, providing a code. Based on the phone number country <i>e.g.</i> German phone number, the SMS showned on the picture may be cropped, and the last digit must be “bruteforced”, which is possible since the number of tries seems to be unlimited.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_biedronka_2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_biedronka_2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_biedronka_2-1400.webp"></source> <img src="/assets/img/publicsms_results_biedronka_2.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_biedronka_3-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_biedronka_3-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_biedronka_3-1400.webp"></source> <img src="/assets/img/publicsms_results_biedronka_3.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Finally, I took a look at the application and analysed its HTTP traffic to see if the 6 digit code could be bruteforced, and luckily it can’t be bruteforced in a reliable.</p> <h6 id="impact-2">Impact</h6> <p>When connecting to a user account, there is not much to do. Of course it discloses email address when fullfilled, and maybe credit card information since Biedronka works with a partner called BLIK, but I didn’t investigate this.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_biedronka_4-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_biedronka_4-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_biedronka_4-1400.webp"></source> <img src="/assets/img/publicsms_results_biedronka_4.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h6 id="responsible-disclosure-2">Responsible disclosure</h6> <p>TODO</p> <p><a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h5 id="job-logic">Job Logic</h5> <p>JobLogic is an Enterprise Resource Management SaaS application that provides many different services such as payment integration, jobs management, planning, and so on. Here is the message received : “Your Job has been completed Please follow the link for details https://staging-portal.joblogic.com/Portal?id=GUID.”</p> <p>Navigating to this URL directly provides access to a portal, authenticated as a user. As you noticed, this is a staging environment, which means that no real data should be found.</p> <h6 id="impact-3">Impact</h6> <h6 id="responsible-disclosure-3">Responsible disclosure</h6> <p>12/04/2023 - Issue reported <a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h5 id="free-ads">Free ads</h5> <p>Free Ads is a UK application that allows user to publish ads to sell whatever they want, for free. The service proposes a paid version for users who want their ad to have more visibility. The message received looks like this:</p> <ul> <li><code>Hi REDACTED, you have a new message, click to go to your messages &gt;&gt; https://go.freeads.co.uk/REDACTED.</code></li> </ul> <p>This URL redirects to https://my.freeads.co.uk/messages/list/all?c=REDACTED%3D%3D&amp;utm_source=message_reminder&amp;utm_medium=sms&amp;utm_campaign=message and sets a cookie session that allows to be authenticated as a user. Unlike most of these URLs, this one does not expires!</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_freeads_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_freeads_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_freeads_1-1400.webp"></source> <img src="/assets/img/publicsms_results_freeads_1.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h6 id="impact-4">Impact</h6> <p>This URL gives full access to the user account, and enables an attacker to read/write personal information. As far as I can tell, credit card information is not stored by FreeAds since a premium account is a one time payment.</p> <h6 id="responsible-disclosure-4">Responsible disclosure</h6> <p>12/04/2023 - Issue reported</p> <p><a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h5 id="airindia">AirIndia</h5> <p>According to Wikipedia, AirIndia is the second-largest airline in India in terms of passengers carried, after IndiGo, as of July 2023. The text message received for Air India was the following.</p> <ul> <li> <code>Thank you for flying with us. Please take a few moments to share your thoughts. To rate your experience, click: https://nps.airindia.in/rEDaCt3d -Air</code>.</li> </ul> <p>When navigating to the URL, we are redirected to Qualtrics, a SaaS solution to create various things, including surveys. In order for me to understand how it works, I created a test survey available <a href="https://qualtricsxmfx7yt665q.qualtrics.com/jfe/form/SV_57KnpcbkNjHQ6uq" target="_blank" rel="noopener noreferrer">here</a> that reads a URL parameter <b>Name</b> and display its value in the first question. Example with a survey for <a href="https://qualtricsxmfx7yt665q.qualtrics.com/jfe/form/SV_57KnpcbkNjHQ6uq?Name=Molx" target="_blank" rel="noopener noreferrer">Molx</a>, or for <a href="https://qualtricsxmfx7yt665q.qualtrics.com/jfe/form/SV_57KnpcbkNjHQ6uq?Name=Bender" target="_blank" rel="noopener noreferrer">Bender</a>.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_airindia_0-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_airindia_0-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_airindia_0-1400.webp"></source> <img src="/assets/img/publicsms_results_airindia_0.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>With AirIndia, the issue is that all surveys include very sensitive data, including PII and also the PNR unique identifier. Or course I double checked this data using services like <a href="https://flightstats.com/" target="_blank" rel="noopener noreferrer">https://flightstats.com/</a>, and all of it was real!</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_airindia_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_airindia_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_airindia_1-1400.webp"></source> <img src="/assets/img/publicsms_results_airindia_1.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>The following table shows all information disclosed by AirIndia as URL parameters.</p> <table id="custom" class="t-border"> <caption style="text-align:center"><b>AirIndia disclosed data</b></caption> <tr> <th>Field</th> <th>Field description</th> <th>Raw value</th> <th>Value meaning</th> </tr> <tr> <td>PNR</td> <td>Reservation unique identifier</td> <td>REDACTED</td> <td>REDACTED</td> </tr> <tr> <td>ORG</td> <td>Origin (IATA code)</td> <td>DEL</td> <td>Indira Gandhi International Airport (DEL)</td> </tr> <tr> <td>DES</td> <td>Destination (IATA code)</td> <td>YVR</td> <td>Vancouver International Airport (YVR)</td> </tr> <tr> <td>PFN</td> <td>First name</td> <td>REDACTED</td> <td>REDACTED</td> </tr> <tr> <td>PLN</td> <td>Last name</td> <td>REDACTED</td> <td>REDACTED</td> </tr> <tr> <td>PEmail</td> <td>Email</td> <td>REDACTED</td> <td>REDACTED</td> </tr> <tr> <td>PPhone</td> <td>Phone</td> <td>447487710863</td> <td>447487710863</td> </tr> <tr> <td>FlightNumber</td> <td>Flight number</td> <td>REDACTED</td> <td>REDACTED</td> </tr> <tr> <td>FlightDate</td> <td>Flight date</td> <td>02%20Feb%2024</td> <td>02 Feb 24</td> </tr> <tr> <td>Class</td> <td>Class</td> <td>Q</td> <td>Q</td> </tr> <tr> <td>Environment</td> <td>Environment</td> <td>Production</td> <td>Production</td> </tr> </table> <p>If you ever travelled by plane, you may understand what an attacker could do right? Here is the answer.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_airindia_2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_airindia_2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_airindia_2-1400.webp"></source> <img src="/assets/img/publicsms_results_airindia_2.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h6 id="impact-5">Impact</h6> <p>So an attacker can connect to the check-in web page, but what does this mean?</p> <ul> <li> <b>Situation 1</b> - If the flight is in a few weeks or month, travellers are not allowed to check-in. In this situation, an attacker can’t do anything except get the list of flights related to the PNR.</li> <li> <b>Situation 2</b> - If the traveller can check-in, well, an attacker could check-in.</li> <li> <b>Situation 3</b> - If the traveller already checked-in, an attacker would have access to a boarding pass that provides additional information such as a Passport number or a VISA number, and can still modify information on the boarding pass.</li> </ul> <p>A curious thing is that the survey is meant to get get a feedback about reservation, check-in, in-flight meal, arrival and exit, but it seems to be sent immediately after tickets are bought <i>i.e.</i> before the flight date.</p> <h6 id="responsible-disclosure-5">Responsible disclosure</h6> <p>15/04/2023 - Issue reported</p> <p><a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h5 id="elilly">e.lilly</h5> <p>According to Wikipedia, Eli Lilly and Company is an American pharmaceutical company headquartered in Indianapolis, Indiana, with offices in 18 countries. Its products are sold in approximately 125 countries. People who sign up on <a href="https://zepbound.lilly.com" target="_blank" rel="noopener noreferrer">https://zepbound.lilly.com</a> need to register a phone number. Then, the following messages are sent.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_elilly_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_elilly_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_elilly_1-1400.webp"></source> <img src="/assets/img/publicsms_results_elilly_1.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>First URL By navigating to the first URL (1/2), I was redirected to the following web page, allowing to access personal information such as : email address, first name, last name, signature (by accessing the signed HIPAA document).</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_elilly_2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_elilly_2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_elilly_2-1400.webp"></source> <img src="/assets/img/publicsms_results_elilly_2.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>By navigating to the second URL (2/2), I was redirected to a web page allowing me to download my wallet on Apple Wallet or Google Pay. I connected to my Google account and saved the savings card.</p> <h6 id="impact-6">Impact</h6> <p>PII disclosure.</p> <h6 id="responsible-disclosure-6">Responsible disclosure</h6> <p>16/07/2024 - Issue reported 04/09/2024 - Evaluated as not applicable</p> <p><a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h5 id="texts-from-my-ex">Texts from my ex</h5> <p>A funny name right? The concept is also funny : this is a SaaS app where users upload a part of their conversation (WhatsApp, Messenger and so on) with their crush or ex, and an AI evaluates how compatible the two persons are. Unfortunately, I got rid of the message, so I can’t tell how it looks like, but I have a URL example :</p> <ul> <li><code>https://textsfrommyex.com/analysis/65bdREDACTED3655</code></li> </ul> <h6 id="impact-7">Impact</h6> <p>The impact entirely relies on the messages content. In the following example, the only sensitive infomation are first and last names. However, since this ‘report’ quotes the conversation, any sensitive information in that conversation could be present.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_textsfrommyex_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_textsfrommyex_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_textsfrommyex_1-1400.webp"></source> <img src="/assets/img/publicsms_results_textsfrommyex_1.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h6 id="responsible-disclosure-7">Responsible disclosure</h6> <p>Not reported.</p> <p><a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h5 id="stickermule">Stickermule</h5> <p>Stickermule is a website where sticker can be bought. The message received looks like this.</p> <ul> <li><code>Items from Sticker Mule order R236623233 shipped! http://stickermule.com/orders/R236623233?token=REDACTED</code></li> </ul> <h6 id="impact-8">Impact</h6> <p>When navigating to the URL, an attacker can access shipment information <i>i.e.</i> first name, last name and physical address and the list of stickers bought. Thus, the user account is not compromised.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_stickermule_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_stickermule_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_stickermule_1-1400.webp"></source> <img src="/assets/img/publicsms_results_stickermule_1.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h6 id="responsible-disclosure-8">Responsible disclosure</h6> <p>01/05/2023 - Issue reported</p> <p><a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h5 id="abinitio-solutions">Abinitio solutions</h5> <p>In the context of the received message, Abinitio solutions is a subcontractor of the Spanish Naturgy Iberia energy provider. In the following message, the user is required to pay their bills.</p> <ul> <li><code>ABINITIO INFORMA REDACTED Pulse https://abinitio-solutions.com/n.php?p=RUIzNlREDACTED para el abono de sus facturas con NATURGY IBERIA</code></li> </ul> <p>When navigating to the URL we have a bill detail with the customer personal information <i>i.e.</i> first name, last name and address.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_abinitio_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_abinitio_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_abinitio_1-1400.webp"></source> <img src="/assets/img/publicsms_results_abinitio_1.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>When navigating to the provided URL, we are redirected to a payment page.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_abinitio_2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_abinitio_2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_abinitio_2-1400.webp"></source> <img src="/assets/img/publicsms_results_abinitio_2.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_abinitio_3-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_abinitio_3-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_abinitio_3-1400.webp"></source> <img src="/assets/img/publicsms_results_abinitio_3.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h6 id="impact-9">Impact</h6> <p>PII disclosure.</p> <h6 id="responsible-disclosure-9">Responsible disclosure</h6> <p>TODO</p> <p><a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h5 id="communidad-madrid">Communidad madrid</h5> <p>This is one of the few cases where I could discover data about the target itself. The message received looked like this.</p> <ul> <li><code>Codigo de activacion para Y5****67J: 746656. Valide su identidad y confirme su codigo en: https://registroidentifica.val.communidad.madrid/#/activacion</code></li> <li><code>Codigo de activacion para 71****17M: 340352. Valide su identidad y confirme su codigo en: https://intranet.val.communidad.madrid/#/activacion</code></li> </ul> <p>This gives the opportunity to discover additional scope about the <code>communidad.madrid</code> domain.</p> <h6 id="impact-10">Impact</h6> <p>Subdomain discovery.</p> <h6 id="responsible-disclosure-10">Responsible disclosure</h6> <p>Not reported.</p> <p><a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h5 id="ups-scam">UPS Scam</h5> <p>Not many things to say about this : this is a typical scam reproducing the UPS website, hosted at <a href="https://zpr.io/NDcExv3zuFmX" target="_blank" rel="noopener noreferrer">https://zpr.io/NDcExv3zuFmX</a>.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_ups_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_ups_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_ups_1-1400.webp"></source> <img src="/assets/img/publicsms_results_ups_1.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publicsms_results_ups_2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publicsms_results_ups_2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publicsms_results_ups_2-1400.webp"></source> <img src="/assets/img/publicsms_results_ups_2.png" class="img-fluid rounded z-depth-1 imgc" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h6 id="impact-11">Impact</h6> <p>N/A</p> <h6 id="responsible-disclosure-11">Responsible disclosure</h6> <p>N/A</p> <p><a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h5 id="payfone">Payfone</h5> <p>This is a missed opportunity because the URL is truncated. The URL looked like this :</p> <ul> <li><code>https://device.staging.payfone.com:4443/fortified/2015/06/01/continueAuth?vfp=some-truncated-random-string</code></li> </ul> <h6 id="impact-12">Impact</h6> <p>N/A</p> <h6 id="responsible-disclosure-12">Responsible disclosure</h6> <p>N/A</p> <p><a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h5 id="validahealth">Validahealth</h5> <p>This is a missed opportunity because the URL is truncated. The message looked like this :</p> <ul> <li><code>Here you can find an access code for Valida Health. Code : 4203, link to the confirmation page : https://validahealth.io/myresults/confirm/230649ae-3918</code></li> </ul> <h6 id="impact-13">Impact</h6> <p>N/A</p> <h6 id="responsible-disclosure-13">Responsible disclosure</h6> <p>N/A</p> <p><a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h5 id="experian">Experian</h5> <p>This is a missed opportunity because the URL is truncated. The URL looked like this :</p> <ul> <li><code>https://usa.experian.com/registration/v?r=some-random-string</code></li> </ul> <h6 id="impact-14">Impact</h6> <p>N/A</p> <h6 id="responsible-disclosure-14">Responsible disclosure</h6> <p>N/A</p> <p><a href="#real-world-examples">Back to the table ⬆️</a></p> <hr> <h2 id="conclusion">Conclusion</h2> <p>Based on the sample of results we saw, there are two main outcomes I would like to highlight.</p> <p>First, by assuming that phone numbers are private, companies allow themselves to send sensitive information by SMS e.g. URL to access a user account. Of course password reset is a specific case that requires the phone number to be trusted, but this is quite difficult to exploit because of race conditions and additional limit rate protection that can be set up (c.f. the Instagram case). Otherwise, companies may set up a blacklisting system to prevent users to register with PSS phone numbers : this is quite easy to implement.</p> <p>Second, when registering on an application with a PSS phone number, <b>we have no way to know what SMS will be sent</b>. Thus, I would recommend the use of such phone number for testing purposes, and to avoid associating real data to whatever account was created with the phone number.</p> <p><i>Thanks for reading</i></p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 CyberIntruder - Molx32 . </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-MFVVRMM3DK"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-MFVVRMM3DK");</script> </body> </html>